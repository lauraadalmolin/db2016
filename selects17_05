-- 1. Todas as linhas da tabela Cliente;
SELECT * FROM Cliente;

-- 2. Os números dos telefones que cujos contratos iniciaram em 1999, mostrando também a
-- data de início (ordenar por ordem decrescente de data);
SELECT NUMERO FROM TELEFONE WHERE EXTRACT(YEAR from DATAINICIO) = 1999 ORDER BY DATAINICIO

-- 3. Os nomes dos clientes cuja data de nascimento não é conhecida;
SELECT NOME FROM CLIENTE WHERE DATANASC IS NULL

-- 4. A quantidade total de clientes;
SELECT COUNT(*) AS NUMEROCLIENTES FROM CLIENTE

-- 5. A quantidade total de telefones;
SELECT COUNT(*) AS NUMEROTELEFONES FROM TELEFONE

-- 6. A quantidade total de telefones cujo contrato iniciou em maio de 1999;
SELECT COUNT(*) FROM TELEFONE WHERE EXTRACT(MONTH FROM DATAINICIO) = 5 AND EXTRACT(YEAR FROM DATAINICIO) = 1999

-- 7. O maior salário e a média de salário dos clientes;
SELECT MAX(SALARIO), AVG(SALARIO) FROM CLIENTE

-- 8. As datas em que houve início de contratos (não repetir datas em duplicidade);
SELECT COUNT(DATAINICIO), DATAINICIO FROM TELEFONE GROUP BY DATAINICIO 

-- 9. Os nomes dos clientes da cidade de Porto Alegre;
SELECT CLI.NOME 
FROM CLIENTE AS CLI INNER JOIN CIDADE AS CID ON (CLI.CIDADE_CODCIDADE = CID.CODCIDADE)
WHERE CID.NOME = 'PORTO ALEGRE'

-- 10.Os nomes dos clientes da região Sul;
SELECT CLI.NOME
FROM REGIAO AS REG LEFT OUTER JOIN ESTADO AS EST ON (REG.CODREGIAO = EST.REGIAO_CODREGIAO) LEFT OUTER JOIN CIDADE 
AS CID ON (EST.UF = CID.ESTADO_UF) LEFT OUTER JOIN CLIENTE AS CLI ON (CLI.CIDADE_CODCIDADE = CID.CODCIDADE)
WHERE REG.NOME = 'SUL'
-- ou começar por cliente usando apenas inner join
SELECT CLI.NOME
FROM CLIENTE AS CLI INNER JOIN CIDADE AS CID ON (CLI.CIDADE_CODCIDADE = CID.CODCIDADE) INNER JOIN ESTADO AS EST ON (EST.UF = CID.ESTADO_UF)
INNER JOIN REGIAO AS REG ON (REG.CODREGIAO = EST.REGIAO_CODREGIAO)
WHERE REG.NOME = 'SUL'

-- 11.Os nomes dos clientes do Rio Grande do Sul que têm contratos do tipo PRE-PAGO;
SELECT CLI.NOME
FROM CLIENTE AS CLI INNER JOIN TELEFONE AS TEL ON (CLI.CODCLIENTE = TEL.CLIENTE_CODCLIENTE) INNER JOIN TIPOCONTRATO AS CON ON (CON.IDTIPOCONTRATO = TEL.TIPOCONTRATO_IDTIPOCONTRATO)
WHERE CON.DESCRICAO = 'PRE-PAGO'

-- 12.Os nomes das cidades e os nomes dos clientes de cada cidade (as cidades que
-- eventualmente não têm clientes também devem ser apresentadas);
SELECT CID.NOME, CLI.NOME
FROM CIDADE AS CID LEFT OUTER JOIN CLIENTE AS CLI ON (CLI.CIDADE_CODCIDADE = CID.CODCIDADE)


-- 13.Os nomes de TODAS as regiões, suas unidades federativas e suas cidades cadastradas;
SELECT REG.NOME, EST.NOME, CID.NOME 
FROM REGIAO AS REG LEFT OUTER JOIN ESTADO AS EST ON (REG.CODREGIAO = EST.REGIAO_CODREGIAO) LEFT OUTER JOIN CIDADE 
AS CID ON (EST.UF = CID.ESTADO_UF) 


-- 14.A quantidade de telefones do cliente de nome HUMBERTO;
SELECT COUNT(NUMERO) 
FROM CLIENTE AS CLI LEFT OUTER JOIN TELEFONE AS TEL ON (CLI.CODCLIENTE = TEL.CLIENTE_CODCLIENTE)
WHERE CLI.NOME = 'HUMBERTO'

-- 15.A quantidade de contratos (telefones) da cidade de Porto Alegre;
SELECT COUNT(NUMERO)
FROM CIDADE AS CID LEFT OUTER JOIN CLIENTE AS CLI ON (CLI.CIDADE_CODCIDADE = CID.CODCIDADE) LEFT OUTER JOIN
TELEFONE AS TEL ON (CLI.CODCLIENTE = TEL.CLIENTE_CODCLIENTE)
WHERE CID.NOME = 'PORTO ALEGRE'


